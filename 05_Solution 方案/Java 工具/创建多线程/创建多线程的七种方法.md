
[toc]

## 1ã€ä»€ä¹ˆæ˜¯å¤šçº¿ç¨‹

â€‹		çº¿ç¨‹è¢«ç§°ä¸ºè½»é‡çº§è¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹ä¼šæœ‰å¤šä¸ªçº¿ç¨‹ã€‚ä½†ä¸€ä¸ªçº¿ç¨‹æ˜¯ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­æœ€å°å•ä½ï¼Œæ¯ä¸ªç¨‹åºè‡³å°‘ä¸€æ¡çº¿ç¨‹

## 2ã€çº¿ç¨‹çŠ¶æ€

1. æ–°å»ºï¼ˆnewï¼‰åˆ›å»ºåå°šæœªå¯åŠ¨çº¿ç¨‹
2. è¿è¡Œï¼ˆRunableï¼‰ï¼šåŒ…æ‹¬Runingã€Readyï¼Œå¤„äºè¿™ç§æƒ…å†µçš„çº¿ç¨‹æœ‰å¯èƒ½æ­£åœ¨æ‰§è¡Œï¼Œä¹Ÿæœ‰å¯èƒ½ç­‰å¾…CPUä¸ºä»–åˆ†é…èµ„æº
3. ç­‰å¾…ï¼ˆWatingï¼‰ï¼šè¿™ç§çŠ¶æ€çš„çº¿ç¨‹ä¸ä¼šè¢«åˆ†é…CPUæ‰§è¡Œæ—¶é—´ï¼Œç­‰å¾…åˆ†ä¸ºæ— é™æœŸç­‰å¾…å’Œæœ‰é™æœŸç­‰å¾…ï¼Œå¤„äºæ— é™æœŸç­‰å¾…çš„çº¿ç¨‹éœ€è¦è¢«å…¶ä»–çº¿ç¨‹æ˜¾ç¤ºå¬å”¤ï¼Œæ²¡æœ‰è®¾ç½®TimeOutå‚æ•°çš„Object.waitï¼ˆï¼‰ã€æ²¡æœ‰è®¾ç½®Timeoutå‚æ•°çš„ Thread.joinï¼ˆï¼‰æ–¹æ³•éƒ½ä¼šè¿›å…¥æ— é™æœŸç­‰å¾…çŠ¶æ€ï¼›æœ‰é™æœŸç­‰å¾…æ— é¡»ç­‰å¾…å…¶ä»–çº¿ç¨‹å¬å”¤ï¼Œåœ¨ä¸€å®šæ—¶é—´ç”±ç³»ç»Ÿè‡ªåŠ¨æ¿€æ´»ï¼ŒThread.sleepï¼ˆï¼‰ï¼Œè®¾ç½®äº†TimeOutå‚æ•°çš„Object.wai tï¼ˆï¼‰
4. é˜»å¡ï¼ˆBlockedï¼‰ï¼šçº¿ç¨‹è¢«é˜»å¡ï¼Œé˜»å¡çŠ¶æ€â€œåœ¨ç­‰å¾…ç€è·å–åˆ°ä¸€ä¸ªæ’ä»–é”ï¼Œè¿™ä¸ªæ—¶é—´å°†åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ”¾å¼ƒè¿™ä¸ªé”çš„æ—¶å€™å‘ç”Ÿï¼›è€Œâ€ç­‰å¾…çŠ¶æ€â€œåˆ™æ˜¯åœ¨ç­‰å¾…ä¸€æ®µæ—¶é—´æˆ–è€…å”¤é†’åŠ¨ä½œçš„å‘ç”Ÿã€‚åœ¨ç¨‹åºç­‰å¾…è¿›å…¥åŒæ­¥åŒºåŸŸçš„æ—¶å€™ï¼Œçº¿ç¨‹å°†è¿›å…¥è¿™ç§çŠ¶æ€ã€‚
5. ç»“æŸï¼ˆTerminatedï¼‰ï¼šç»ˆæ­¢çº¿ç¨‹

## 3ã€çº¿ç¨‹åŒæ­¥æ–¹æ³•

+ wait()ï¼šä½¿çº¿ç¨‹å¤„äºä¸€ç§ç­‰å¾…çŠ¶æ€ï¼Œé‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡é”ã€‚

+ sleep()ï¼šä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè°ƒç”¨å®ƒæ—¶è¦æ•è·InterruptedExceptionå¼‚å¸¸ï¼Œä¸é‡Šæ”¾å¯¹è±¡é”ã€‚

+ notify()ï¼šå”¤é†’ä¸€ä¸ªæ­£åœ¨ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ã€‚æ³¨æ„è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çŸ¥é“å”¤é†’çš„æ˜¯å“ªä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ˜¯ç”±JVMæ¥å†³å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œä¸æ˜¯ç”±çº¿ç¨‹ä¼˜å…ˆçº§å†³å®šçš„ã€‚

+ notifyAll()ï¼šå”¤é†’æ‰€æœ‰ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ³¨æ„å¹¶ä¸æ˜¯ç»™æ‰€æœ‰å”¤é†’çº¿ç¨‹ä¸€ä¸ªå¯¹è±¡é”ï¼Œè€Œæ˜¯è®©å®ƒä»¬ç«äº‰ã€‚

## 4ã€åˆ›å»ºçº¿ç¨‹çš„ä¸ƒç§æ–¹æ³•ï¼ˆé‡è¦ï¼‰

### 4.1ã€ç»§æ‰¿Threadç±»

```java
class ThreadTest {

    public static void main(String[] args) {
        noAnonymity();
    }

  	//	åŒ¿ååˆ›å»ºå¤šçº¿ç¨‹
    public static void anonymity(){
        for (int i = 0; i < 10; i++) {
            new Thread(()->{
                System.out.println(Thread.currentThread().getName() + "\t åˆ›å»ºçº¿ç¨‹");
            }).start();
        }
    }
		// éåŒ¿ååˆ›å»ºå¤šçº¿ç¨‹
    public static void noAnonymity(){
        for (int i = 0; i < 10; i++) {
            new MyThread().start();
        }
    }
}

class MyThread extends Thread{
    @Override
    public void run() {
        System.out.println(Thread.currentThread().getName() + "\t åˆ›å»ºçº¿ç¨‹");
    }
}
```

### 4.2ã€å®ç°Runnable

```java
class RunnableTest {
    public static void main(String[] args) {
        anonymity();
    }

    //   åŒ¿ååˆ›å»º
    public static void anonymity(){
        for (int i = 0; i < 10; i++) {
            new Thread(new Runnable() {
                @Override
                public void run() {
                    System.out.println(Thread.currentThread().getName()+"\t åˆ›å»ºçº¿ç¨‹");
                }
            }).start();
        }
    }

    // éåŒ¿ååˆ›å»º
    public static void unAnonymity(){
        for (int i = 0; i < 10; i++) {
            Thread thread = new Thread(new MyRunnable());
            thread.start();
        }
    }
}

class MyRunnable implements Runnable{
    @Override
    public void run() {
        System.out.println(Thread.currentThread().getName()+"\t åˆ›å»ºçº¿ç¨‹");
    }
}
```

![image-20210514143223490](images/image-20210514143223490.png)

### 4.3ã€å®ç°Callableæ¥å£

```java
class CallableTest {
    public static void main(String[] args) throws ExecutionException, InterruptedException {
        for (int i = 0; i < 10; i++) {
            FutureTask<Integer> futureTask = new FutureTask<>(new MyCallableTest());
            new Thread(futureTask).start();
            System.out.println(futureTask.get());
        }
    }
}

class MyCallableTest implements Callable<Integer>{
    @Override
    public Integer call() throws Exception {
        System.out.println(Thread.currentThread().getName() +"\t åˆ›å»ºçº¿ç¨‹");
        return 1;
    }
}
```

### 4.4ã€åˆ›å»ºçº¿ç¨‹æ± 

```java
class ThreadPoolTest {
    public static void main(String[] args) {
        Anonymity();
    }

    // åŒ¿ååˆ›å»º
    public static void Anonymity(){
        ExecutorService es = Executors.newFixedThreadPool(5);
        for (int i = 0; i < 10; i++) {
            es.execute(new Runnable() {
                @Override
                public void run() {
                    System.out.println(Thread.currentThread().getName() +"\tçº¿ç¨‹åˆ›å»º");
                }
            });
        }
    }

    // éåŒ¿ååˆ›å»º
    public static void unAnonymity(){
        ExecutorService es = Executors.newFixedThreadPool(4);
        for (int i = 0; i < 10; i++) {
            ThreadPool tp = new ThreadPool();
            es.submit(tp);
        }
        // å…³é—­çº¿ç¨‹æ±   å¦‚æœä¸å…³é—­ï¼Œåˆ™æ°¸è¿œåœæ»åœ¨è¿™é‡Œ
        es.shutdown();
    }
}

class ThreadPool implements Runnable{
    @Override
    public void run() {
        System.out.println(Thread.currentThread().getName() +"\tçº¿ç¨‹åˆ›å»º");
    }
}
```

### 4.5ã€å®šæ—¶å™¨

```java
public void schedule(TimerTask task, Date firstTime, long period){}
// task ä»»åŠ¡
// firstTime ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶é—´
// æ—¶éš”å¤šå°‘æ—¶é—´æ‰§è¡Œä¸€æ¬¡

public void schedule(TimerTask task, long delay, long period){}
// delay æ‰§è¡Œæ¬¡ä»»åŠ¡å‰ï¼Œç­‰å¾…æ—¶å¸¸ å¦‚æœä¸º0 å°±æ˜¯ç«‹å³æ‰§è¡Œ
```

```java
public class TimerTest {
    public static void main(String[] args) {
        Date date = new Date();
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss");
        System.out.println("ç³»ç»Ÿå¯åŠ¨æ—¶é—´ï¼š"+sdf.format(date));
        Calendar newTime = Calendar.getInstance();
        newTime.setTime(date);
        // åŠ 5ç§’
        newTime.add(Calendar.SECOND,5);
        Date time = newTime.getTime();
        System.out.println("é¢„è®¡å®šæ—¶å™¨å¯åŠ¨æ—¶é—´"+sdf.format(time));

        Timer timer = new Timer();
        // å®šæ—¶å™¨
        timer.schedule(new TimerTask() {
            @Override
            public void run() {
                System.out.println("ç³»ç»Ÿå¯åŠ¨å5ç§’å¼€å§‹æ‰§è¡Œ , æ¯éš” 2 ç§’ æ‰§è¡Œä¸€æ¬¡");
            }
        },time,2000);

        // æ‰“å°æ—¶é—´æˆ³
        new Thread(()->{
            timer.schedule(new TimerTask() {
                @Override
                public void run() {
                    System.out.println("Thread-çº¿ç¨‹\t æ‰“å°æ—¶é—´æˆ³:"+sdf.format(new Date()));
                }
            },0,1000);
        }).start();
    }
}
```

æ•ˆæœï¼š

![Timer](images/Timer.gif)

### 4.6ã€Lambdaè¡¨è¾¾å¼å®ç°

ä½¿ç”¨ jdk1.8 å¹¶è¡Œæµå½¢å¼

```java
public class LambdaTest {

    public static void main(String[] args) {
        List<Integer> list = Arrays.asList(1,2,3,4,5,6,7);
        list.parallelStream().forEach((s)->{
            System.out.println(Thread.currentThread().getName()+"\tçº¿ç¨‹è·å–åˆ°åˆ°å€¼ä¸ºï¼š\t"+s);
        });
    }
}
```

```txt
main	çº¿ç¨‹è·å–åˆ°åˆ°å€¼ä¸ºï¼š	5
ForkJoinPool.commonPool-worker-6	çº¿ç¨‹è·å–åˆ°åˆ°å€¼ä¸ºï¼š	4
ForkJoinPool.commonPool-worker-9	çº¿ç¨‹è·å–åˆ°åˆ°å€¼ä¸ºï¼š	2
ForkJoinPool.commonPool-worker-13	çº¿ç¨‹è·å–åˆ°åˆ°å€¼ä¸ºï¼š	6
ForkJoinPool.commonPool-worker-4	çº¿ç¨‹è·å–åˆ°åˆ°å€¼ä¸ºï¼š	3
ForkJoinPool.commonPool-worker-2	çº¿ç¨‹è·å–åˆ°åˆ°å€¼ä¸ºï¼š	1
ForkJoinPool.commonPool-worker-11	çº¿ç¨‹è·å–åˆ°åˆ°å€¼ä¸ºï¼š	7

Process finished with exit code 0
```

### 4.7ã€Springå®ç°å¤šçº¿ç¨‹

#### 4.7.1ã€Mavenå·¥ç¨‹å¯¼å…¥Springç›¸å…³ä¾èµ–

â€‹		è¿™é‡Œä¸ºç›´æ¥å¼•ç”¨ Spring-Boot ä¾èµ–ï¼Œé¿å…ç¹çé…ç½® 

```xml
<dependencies>
   <dependency>
     <groupId>org.springframework.boot</groupId>
     <artifactId>spring-boot-starter</artifactId>
     <version>2.3.7.RELEASE</version>
  </dependency>
</dependencies>
```

#### 4.7.2ã€æ–°å»ºJavaç±»ï¼Œå¼€å¯@EnableAsyncæ³¨è§£ 

å¼€å¯é…ç½®ï¼Œæ”¯æŒå¼‚æ­¥ä»»åŠ¡

```java
package love.study.multithreading.cthread;

import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.scheduling.annotation.EnableAsync;

@Configuration
@ComponentScan("love.study.multithreading.cthread")
@EnableAsync
public class SpringConfig {

}
```

### 4.7.3ã€æ–¹æ³•ç±»

ä¹¦å†™å¼‚æ­¥æ‰§è¡Œçš„æ–¹æ³•ç±»(æ³¨æ„æ–¹æ³•ä¸Šéœ€è¦æœ‰@Asyncâ€”â€”å¼‚æ­¥æ–¹æ³•è°ƒç”¨)

```java
package love.study.multithreading.cthread;

import org.springframework.scheduling.annotation.Async;
import org.springframework.stereotype.Service;

@Service
public class SpringAsyncService {

    @Async
    public void AsyncA(){
        System.out.println("A is Running");
    }

    @Async
    public void AsyncB(){
        System.out.println("B is Running");
    }
}
```

### 4.7.4ã€ä¸»æ–¹æ³•ç±»

```java
package love.study.multithreading.cthread;

import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class SpringThreadTest {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class);
        SpringAsyncService bean = ac.getBean(SpringAsyncService.class);
        bean.AsyncA();
        bean.AsyncB();
    }
}
```

è¿è¡Œç»“æœï¼šæœ‰æ—¶Aåœ¨ä¸Šé¢ æœ‰æ—¶Båœ¨ä¸Šé¢ å¯çŸ¥å·²å¼€å¯å¤šçº¿ç¨‹

```
B is Running
A is Running
```

> æœ¬æ–‡åˆ›å»ºäº 2021å¹´5æœˆ14æ—¥
> 
> ä½œè€…ï¼š[Xiang](https://blog.csdn.net/qq_39550368/article/details/116796190)
> 
> å‚è€ƒæ–‡çŒ®ï¼›
> 
> [åˆ›å»ºå¤šçº¿ç¨‹çš„å››ç§æ–¹æ³•](https://www.cnblogs.com/zhou-test/p/9811771.html)
> 
>[åˆ›å»ºçº¿ç¨‹çš„8ç§æ–¹æ³•](https://blog.csdn.net/itcats_cn/article/details/81149232?utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.baidujs&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.baidujs)
> 
>[åˆ›å»ºåŒ¿åçº¿ç¨‹çš„5ç§æ–¹æ³•](https://blog.csdn.net/qq_26106607/article/details/79142904)
>
> ç‰¹åˆ«é¸£è°¢


><center><b><font color=blue >å¥½äº†åˆ°è¿™æˆ‘ä»¬çš„åˆ†äº«ä¹Ÿç»“æŸäº†ğŸ˜‰</font></b></center>
>
><center><b><font color=blue >å¸Œæœ›ä»¥ä¸Šæ–¹æ³•å¯ä»¥å¸®åˆ°æ‚¨ï¼Œç¥æ‚¨å·¥ä½œæ„‰å¿«ï¼ğŸ’–</font></b></center>
>
><center>ğŸ‘‡</center>
><center><b><font color=pink >å¯¹æ‚¨æœ‰å¸®åŠ©çš„è¯è®°ç‚¹èµå¾—æ”¶è—å“¦ï¼ğŸ‘</font></b></center>
><center><font color=blue>æˆ‘æ˜¯</font>       <font color=red>Xiang</font>     <font color=blue>ä»å°ç™½ä¸€æ­¥ä¸€æ­¥åœ°å˜æˆå·¥å…·äºº ğŸ˜›</font></center>

